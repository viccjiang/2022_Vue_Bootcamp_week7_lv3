{"version":3,"sources":["webpack:///./src/views/UserProducts.vue","webpack:///./src/views/UserProducts.vue?d93a"],"names":["class","_createElementVNode","for","role","_hoisted_24","_hoisted_41","_createVNode","_component_Loading","active","$data","type","id","placeholder","$event","_hoisted_5","href","onClick","$route","params","selectCategory","_createElementBlock","_Fragment","_renderList","item","key","_hoisted_7","$options","style","backgroundImage","imageUrl","_toDisplayString","category","title","description","price","origin_price","_ctx","currency","disabled","status","loadingItem","_hoisted_25","includes","_hoisted_27","_hoisted_28","_hoisted_42","_hoisted_44","_hoisted_45","_component_Pagination","pages","onUpdatePage","storageMethods","save","favorite","favoriteString","JSON","stringify","localStorage","setItem","get","parse","getItem","data","cacheSearch","isLoading","products","product","pagination","categories","myFavorite","components","Pagination","provide","emitter","methods","addMyFavorite","console","log","this","splice","indexOf","push","getProducts","page","url","process","$http","then","response","success","getCategories","setPagination","catch","error","$httpMessageState","perPage","total_pages","Math","ceil","length","current_page","has_pre","has_next","minPage","maxPage","slice","Set","forEach","add","getProduct","$router","addCart","cart","product_id","qty","post","res","emit","watch","newValue","preValue","handler","deep","computed","filterProducts","filter","match","filterSearch","mounted","__exports__","render"],"mappings":"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","file":"js/chunk-2d0c5178.7f8ce8ad.js","sourcesContent":["<template>\n  <Loading :active=\"isLoading\"></Loading>\n  <div class=\"container\">\n    <div class=\"row\">\n      <!-- 左側分類欄 -->\n      <div class=\"col-3 mt-4\">\n      <!-- 查詢商品 -->\n      <div class=\"form-floating\">\n        <input type=\"text\" class=\"form-control mb-3\" id=\"search\" placeholder=\"Search\" v-model.lazy=\"cacheSearch\">\n        <label class=\"text-secondary\" for=\"search\">查詢商品</label>\n      </div>\n        <!-- 左側分類欄 -->\n        <div class=\"list-group rounded-0\">\n          <a\n            href=\"#\"\n            class=\"list-group-item list-group-item-action\"\n            @click.prevent=\"selectCategory = ''; this.$route.params.selectCategory = ''\"\n            >全部 </a\n          >\n          <a\n            href=\"#\"\n            v-for=\"item in categories\"\n            :key=\"item\"\n            class=\"list-group-item list-group-item-action\"\n            @click.prevent=\"selectCategory = item\"\n            >{{ item }}</a\n          >\n        </div>\n      </div>\n      <!-- 右側產品列 -->\n      <div class=\"col-9\">\n        <div class=\"row mt-4\">\n          <div class=\"col mb-4\">\n            <div class=\"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4\">\n              <!-- 如果有查詢商品-->\n              <template v-if=\"cacheSearch\">\n                <div class=\"col\" v-for=\"item in filterSearch\" :key=\"item.id\">\n                <div class=\"card h-100 rounded-0\">\n                  <a\n                    href=\"#\"\n                    class=\"rounded-0 \"\n                    @click.prevent=\"getProduct(item.id)\"\n                  >\n                    <div\n                      style=\"\n                        height: 300px;\n                        background-size: cover;\n                        background-position: center;\n                      \"\n                      :style=\"{ backgroundImage: `url(${item.imageUrl})` }\"\n                    ></div>\n                  </a>\n                  <!-- <img :src=\"item.imageUrl\" class=\"card-img-top\" alt=\"...\" /> -->\n                  <div class=\"card-body\">\n                    <span class=\"badge bg-secondary text-light mb-2\">{{\n                      item.category\n                    }}</span>\n                    <h5 class=\"card-title\">{{ item.title }}</h5>\n                    <h6 class=\"h6 text-secondary\">\n                      {{ item.description }}\n                    </h6>\n\n                    <div class=\"h5 list-inline-item\" v-if=\"!item.price\">\n                      {{ item.origin_price }} 元\n                    </div>\n                    <del\n                      class=\"h6 list-inline-item text-secondary mt-4\"\n                      v-if=\"item.price\"\n                      >原價 NT$\n                      {{ $filters.currency(item.origin_price) }} 元</del\n                    >\n                    <div class=\"h5 text-danger mb-3\" v-if=\"item.price\">\n                      NT$ {{ $filters.currency(item.price) }} 元\n                    </div>\n                    <!-- 按鈕 -->\n                    <div class=\"d-grid gap-2 col-12 mx-auto\">\n                      <!-- 加入購物車 -->\n                      <button\n                        type=\"button\"\n                        class=\"btn btn-outline-secondary rounded-0 border\"\n                        :disabled=\"this.status.loadingItem === item.id\"\n                        @click=\"addCart(item.id)\"\n                      >\n                        <div\n                          v-if=\"this.status.loadingItem === item.id\"\n                          class=\"spinner-border text-danger spinner-border-sm\"\n                          role=\"status\"\n                        >\n                          <span class=\"visually-hidden\">Loading...</span>\n                        </div>\n                        加到購物車\n                      </button>\n                      <!-- 我的最愛 -->\n                      <button\n                        type=\"button\"\n                        @click=\"addMyFavorite(item)\"\n                        :class=\"{ active: myFavorite.includes(item.id) }\"\n                        class=\"\n                          btn\n                          d-block\n                          btn-outline-secondary\n                          rounded-0\n                          border\n                        \"\n                      >\n                        加到我的最愛\n                      </button>\n                      <!-- 查看細節 -->\n                      <button\n                        type=\"button\"\n                        class=\"btn btn-outline-secondary rounded-0 border\"\n                        @click=\"getProduct(item.id)\"\n                      >\n                        查看更多\n                      </button>\n                    </div>\n                  </div>\n                </div>\n                </div>\n              </template>\n              <!-- 如果沒有查詢商品-->\n              <template v-else>\n              <div class=\"col\" v-for=\"item in filterProducts\" :key=\"item.id\">\n                <div class=\"card h-100 rounded-0\">\n                  <a\n                    href=\"#\"\n                    class=\"rounded-0 \"\n                    @click.prevent=\"getProduct(item.id)\"\n                  >\n                    <div\n                      style=\"\n                        height: 300px;\n                        background-size: cover;\n                        background-position: center;\n                      \"\n                      :style=\"{ backgroundImage: `url(${item.imageUrl})` }\"\n                    ></div>\n                  </a>\n                  <!-- <img :src=\"item.imageUrl\" class=\"card-img-top\" alt=\"...\" /> -->\n                  <div class=\"card-body\">\n                    <span class=\"badge bg-secondary text-light mb-2\">{{\n                      item.category\n                    }}</span>\n                    <h5 class=\"card-title\">{{ item.title }}</h5>\n                    <h6 class=\"h6 text-secondary\">\n                      {{ item.description }}\n                    </h6>\n\n                    <div class=\"h5 list-inline-item\" v-if=\"!item.price\">\n                      {{ item.origin_price }} 元\n                    </div>\n                    <del\n                      class=\"h6 list-inline-item text-secondary mt-4\"\n                      v-if=\"item.price\"\n                      >原價 NT$\n                      {{ $filters.currency(item.origin_price) }} 元</del\n                    >\n                    <div class=\"h5 text-danger mb-3\" v-if=\"item.price\">\n                      NT$ {{ $filters.currency(item.price) }} 元\n                    </div>\n                    <!-- 按鈕 -->\n                    <div class=\"d-grid gap-2 col-12 mx-auto\">\n                      <!-- 加入購物車 -->\n                      <button\n                        type=\"button\"\n                        class=\"btn btn-outline-secondary rounded-0 border\"\n                        :disabled=\"this.status.loadingItem === item.id\"\n                        @click=\"addCart(item.id)\"\n                      >\n                        <div\n                          v-if=\"this.status.loadingItem === item.id\"\n                          class=\"spinner-border text-danger spinner-border-sm\"\n                          role=\"status\"\n                        >\n                          <span class=\"visually-hidden\">Loading...</span>\n                        </div>\n                        加到購物車\n                      </button>\n                      <!-- 我的最愛 -->\n                      <button\n                        type=\"button\"\n                        @click=\"addMyFavorite(item)\"\n                        :class=\"{ active: myFavorite.includes(item.id) }\"\n                        class=\"\n                          btn\n                          d-block\n                          btn-outline-secondary\n                          rounded-0\n                          border\n                        \"\n                      >\n                        加到我的最愛\n                      </button>\n                      <!-- 查看細節 -->\n                      <button\n                        type=\"button\"\n                        class=\"btn btn-outline-secondary rounded-0 border\"\n                        @click=\"getProduct(item.id)\"\n                      >\n                        查看更多\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              </template>\n            </div>\n          </div>\n          <!-- 分頁 -->\n          <Pagination\n            :pages=\"pagination\"\n            @update-page=\"getProducts\"\n          ></Pagination>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport emitter from '@/methods/emitter';\nimport Pagination from '../components/Pagination.vue';\n// LocalStorage\n// 轉型\nconst storageMethods = {\n  save(favorite) {\n    const favoriteString = JSON.stringify(favorite);\n    // hexFavorite\n    localStorage.setItem('hexFavorite', favoriteString);\n  },\n  get() {\n    return JSON.parse(localStorage.getItem('hexFavorite'));\n  },\n};\nexport default {\n  data() {\n    return {\n      cacheSearch: '', // 搜尋輸入\n      isLoading: false,\n      products: [],\n      product: {},\n      pagination: '',\n      status: {\n        loadingItem: '', // 對應品項 id\n      },\n      categories: [],\n      selectCategory: '',\n      myFavorite: storageMethods.get() || [],\n    };\n  },\n  components: {\n    Pagination,\n  },\n  provide() {\n    return {\n      emitter,\n    };\n  },\n  methods: {\n    addMyFavorite(item) {\n      console.log('addMyFavorite');\n      // this.myFavorite.push(item.id);\n      if (this.myFavorite.includes(item.id)) {\n        this.myFavorite.splice(this.myFavorite.indexOf(item.id), 1);\n      } else {\n        this.myFavorite.push(item.id);\n      }\n      console.log(this.myFavorite);\n      // storageMethods.save(this.myFavorite);\n    },\n    getProducts(page = 1) {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/products/all`;\n      this.$http.get(url)\n        .then((response) => {\n          if (!response.data.success) {\n            this.isLoading = false;\n            return;\n          }\n          this.products = response.data.products;\n          console.log('取得全部', this.products);\n          this.getCategories();\n          console.log('取得分類', this.selectCategory);\n          const { selectCategory } = this.$route.params;\n          if (selectCategory) {\n            this.selectCategory = selectCategory;\n          }\n          if (this.selectCategory !== '') {\n            this.pagination = {};\n          } else {\n            this.setPagination(page);\n          }\n          this.isLoading = false;\n        })\n        .catch((error) => {\n          this.$httpMessageState(error, '連線錯誤');\n          this.isLoading = false;\n        });\n    },\n    setPagination(page = 1) {\n      const perPage = 12;\n      this.pagination = {\n        total_pages: Math.ceil(this.products.length / perPage),\n        current_page: page,\n        has_pre: page !== 1,\n        has_next: false,\n        category: null,\n      };\n      if (this.pagination.current_page >= this.pagination.total_pages) {\n        this.pagination.current_page = this.pagination.total_pages;\n        this.pagination.has_next = false;\n      } else {\n        this.pagination.has_next = true;\n      }\n      const minPage = (this.pagination.current_page * perPage) - perPage;\n      const maxPage = (this.pagination.current_page * perPage);\n      this.products = this.products.slice(minPage, maxPage);\n    },\n    getCategories() {\n      // Vue 3 雙向綁定 Proxy(new Proxy 物件)\n      // new Set\n      const categories = new Set();\n      this.products.forEach((item) => {\n        categories.add(item.category);\n      });\n      this.categories = [...categories];\n    },\n    getProduct(id) {\n      this.$router.push(`/product/${id}`);\n    },\n    addCart(id) {\n      const url = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/cart`;\n      this.status.loadingItem = id;\n      const cart = {\n        product_id: id,\n        qty: 1,\n      };\n      this.$http.post(url, { data: cart }).then((res) => {\n        this.status.loadingItem = '';\n        console.log(res);\n        emitter.emit('update-cart'); // 更新購物車數量\n      });\n    },\n  },\n  watch: {\n    selectCategory(newValue, preValue) {\n      if (newValue === '' || preValue === '') {\n        this.getProducts();\n      }\n    },\n    cacheSearch() {\n      const url = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/products/all`;\n      this.$http.get(url).then((response) => {\n        this.products = response.data.products;\n      });\n    },\n    myFavorite: {\n      // 深層監聽\n      handler() {\n        storageMethods.save(this.myFavorite);\n      },\n      deep: true,\n    },\n  },\n  computed: {\n    // 產生新的資料集\n    filterProducts() {\n      return this.products.filter((item) => item.category.match(this.selectCategory));\n      // 空字串，或任何符合結果都會是 “真值”\n    },\n    // 查詢商品\n    filterSearch() {\n      /* 篩選與渲染\n       *  .filter → 陣列內容篩選與條件相符並產生新陣列。\n       *  .match → 找出內容有匹配的資料。\n       *  當 cacheSearch 無資料時，輸出與 products 一樣的陣列，\n       *  當 cacheSearch 有資料時，輸出與 products 有相符的資料。 */\n      return this.products.filter((item) => item.title.match(this.cacheSearch));\n    },\n  },\n  mounted() {\n    // 改為 mounted\n    // this.$http.defaults.baseURL = process.env.VUE_APP_API;\n    this.getProducts();\n  },\n};\n</script>\n","import { render } from \"./UserProducts.vue?vue&type=template&id=93b56f08\"\nimport script from \"./UserProducts.vue?vue&type=script&lang=js\"\nexport * from \"./UserProducts.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\六角學院\\\\2022春季 vue直播班\\\\week7_主線任務lv3\\\\week7_lv3\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}