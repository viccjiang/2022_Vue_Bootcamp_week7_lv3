(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41161d2a"],{"1dde":function(e,t,c){var a=c("d039"),o=c("b622"),n=c("2d00"),r=o("species");e.exports=function(e){return n>=51||!a((function(){var t=[],c=t.constructor={};return c[r]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"711c":function(e,t,c){"use strict";c("ef2a")},"76db":function(e,t,c){"use strict";c.r(t);c("b0c0");var a=c("7a23"),o={key:0,class:"text-center"},n={key:1,class:"container mt-5 p-0"},r=Object(a["createStaticVNode"])('<h2 class="text-center mb-5 fw-bold">購物車</h2><div class="check-step row g-0 align-items-center text-center"><div class="col"><span class="fs-7">1</span><p class="m-3 text-soft">確認訂單</p><div class="step-bar"></div></div><div class="col"><span class="fs-7">2</span><p class="m-3 text-soft">建立訂單</p><div class="step-bar-none"></div></div><div class="col"><span class="fs-7">3</span><p class="m-3 text-soft">完成訂單</p><div class="step-bar-none"></div></div></div>',2),l=[r],s={key:2,class:"container mt-2 mt-md-10"},d={class:"row"},i={class:"col"},u=Object(a["createElementVNode"])("i",{class:"bi bi-trash"}," 清除全部購物車 ",-1),m=[u],b={class:"row g-0"},p={class:"col-3 col-md-2"},f=["src"],j={class:"col-8 col-md-4 ms-2 m-md-2 d-flex justify-content-center align-items-center"},O={class:"card-body p-0"},v=["onClick"],h={class:"card-title fs-6 fw-bold text-soft m-0"},g={key:0,class:"text-success"},V=Object(a["createElementVNode"])("div",{class:"row"},[Object(a["createElementVNode"])("div",{class:"col-12 col-md-6"})],-1),N={class:"col-12 col-md-3 d-flex justify-content-center align-items-center"},E={class:"input-group product-num-group bg-light mt-1 mb-0 my-md-0"},x={class:""},y=["disabled","onClick"],k=Object(a["createElementVNode"])("i",{class:"bi bi-dash-lg"},null,-1),C=[k],w=["onUpdate:modelValue"],$={class:""},B=["disabled","onClick"],D=Object(a["createElementVNode"])("i",{class:"bi bi-plus-lg"},null,-1),S=[D],L={class:"col-1 col-md-1 md-2 d-flex justify-content-end align-items-center ms-auto"},T={class:"card-text mt-2 text-end"},I={class:"text-danger"},_=["disabled","onClick"],q=Object(a["createElementVNode"])("i",{class:"bi bi-trash3"},null,-1),M=[q],U={class:"text-end"},F={class:"mt-2 text-end bg-light border-top border-bottom text-secondary py-2"},z={key:0,class:"row"},P={class:"col-12 col-md-6"},J=Object(a["createElementVNode"])("p",{class:"bg-soft m-0 p-3 text-white"},"顧客資訊",-1),A={class:"col p-5 bg-light"},X={class:"mb-3"},G=Object(a["createElementVNode"])("label",{for:"email",class:"form-label"},[Object(a["createElementVNode"])("span",{class:"text-danger"},"*"),Object(a["createTextVNode"])("Email")],-1),H={class:"mb-3"},K=Object(a["createElementVNode"])("label",{for:"name",class:"form-label"},[Object(a["createElementVNode"])("span",{class:"text-danger"},"*"),Object(a["createTextVNode"])("收件人姓名")],-1),Q={class:"mb-3"},R=Object(a["createElementVNode"])("label",{for:"tel",class:"form-label"},[Object(a["createElementVNode"])("span",{class:"text-danger"},"*"),Object(a["createTextVNode"])("收件人電話")],-1),W={class:"mb-3"},Y=Object(a["createElementVNode"])("label",{for:"address",class:"form-label"},[Object(a["createElementVNode"])("span",{class:"text-danger"},"*"),Object(a["createTextVNode"])("收件人地址")],-1),Z={class:"mb-3"},ee=Object(a["createElementVNode"])("label",{for:"message",class:"form-label"},"備註",-1),te={class:"col-12 col-md-6"},ce=Object(a["createElementVNode"])("p",{class:"bg-soft m-0 p-3 text-white"},"訂單資訊",-1),ae={class:"d-flex my-3"},oe=Object(a["createElementVNode"])("div",{class:"col fw-bold"},"小計：",-1),ne={class:"col fw-bold text-end"},re=Object(a["createElementVNode"])("div",{class:"d-flex"},[Object(a["createElementVNode"])("div",{class:"col fw-bold"},"運費："),Object(a["createElementVNode"])("div",{class:"col fw-bold text-end"},"NT$ 1,000")],-1),le=Object(a["createElementVNode"])("div",{class:"d-flex"},[Object(a["createElementVNode"])("div",{class:"col fw-bold text-soft opacity-50"},"優惠促銷："),Object(a["createElementVNode"])("div",{class:"col fw-bold text-end text-soft opacity-50"}," - NT$ 1,000 ")],-1),se={key:0,class:"input-group mb-3 input-group-sm"},de={class:"input-group-append"},ie={key:1},ue={key:2},me={class:"text-end text-success"},be={class:"mt-2 text-end bg-light border-top border-bottom text-secondary py-2"},pe={class:"text-end my-4 d-grid"};function fe(e,t,c,r,u,k){var D=Object(a["resolveComponent"])("Loading"),q=Object(a["resolveComponent"])("Field"),fe=Object(a["resolveComponent"])("ErrorMessage"),je=Object(a["resolveComponent"])("Form");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createVNode"])(D,{active:u.isLoading,loader:"bars",color:"#236F6B"},null,8,["active"]),0==u.cartData.carts.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",o," 購物車內沒東西，請至產品列表選購 ")):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",n,l)),u.cartData.carts.length>0?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",s,[Object(a["createElementVNode"])("div",d,[Object(a["createElementVNode"])("div",i,[Object(a["createElementVNode"])("button",{type:"button",class:"btn btn-outline-danger btn-sm mb-2",onClick:t[0]||(t[0]=function(e){return k.removeCart()})},m),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(u.cartData.carts,(function(t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:"card pt-2 border-top mb-3 border-0",key:t.id},[Object(a["createElementVNode"])("div",b,[Object(a["createElementVNode"])("div",p,[Object(a["createElementVNode"])("img",{src:t.product.imageUrl,class:"img-fluid",style:{width:"100px",height:"100px","background-position":"center","object-fit":"cover"}},null,8,f)]),Object(a["createElementVNode"])("div",j,[Object(a["createElementVNode"])("div",O,[Object(a["createElementVNode"])("a",{href:"#",onClick:Object(a["withModifiers"])((function(e){return k.getProduct(t.product.id)}),["prevent"])},"產品連結",8,v),Object(a["createElementVNode"])("h5",h,Object(a["toDisplayString"])(t.product.title),1),t.coupon?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",g,"已套用優惠券")):Object(a["createCommentVNode"])("",!0),V])]),Object(a["createElementVNode"])("div",N,[Object(a["createElementVNode"])("div",E,[Object(a["createElementVNode"])("div",x,[Object(a["createElementVNode"])("button",{disabled:t.qty<=1||u.loadingItem===t.id,onClick:function(e){return k.updateCart(t,t.qty--)},class:"btn border-0",type:"button"},C,8,y)]),Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none bg-light border","aria-describedby":"button-addon1","onUpdate:modelValue":function(e){return t.qty=e}},null,8,w),[[a["vModelText"],t.qty,void 0,{lazy:!0}]]),Object(a["createElementVNode"])("div",$,[Object(a["createElementVNode"])("button",{disabled:u.loadingItem===t.id,onClick:function(e){return k.updateCart(t,t.qty++)},class:"btn border-0",type:"button"},S,8,B)])])]),Object(a["createElementVNode"])("div",L,[Object(a["createElementVNode"])("p",T,[Object(a["createElementVNode"])("small",I,[Object(a["createElementVNode"])("div",{class:"",disabled:u.loadingItem===t.id,onClick:function(e){return k.removeCartItem(t.id)}},M,8,_)])])])]),Object(a["createElementVNode"])("div",U," 定價 "+Object(a["toDisplayString"])(e.$filters.currency(t.product.price)),1),Object(a["createElementVNode"])("div",F," 小計 NT$ "+Object(a["toDisplayString"])(e.$filters.currency(t.final_total)),1)])})),128))])]),0!==u.cartData.carts.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",z,[Object(a["createElementVNode"])("div",P,[J,Object(a["createElementVNode"])("div",A,[Object(a["createVNode"])(je,{ref:"form",class:"",onSubmit:k.createOrder},{default:Object(a["withCtx"])((function(e){var c=e.errors;return[Object(a["createElementVNode"])("div",X,[G,Object(a["createVNode"])(q,{id:"email",name:"email",type:"email",class:Object(a["normalizeClass"])(["form-control rounded-0",{"is-invalid":c["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:u.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=function(e){return u.form.user.email=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(fe,{name:"email",class:"invalid-feedback"})]),Object(a["createElementVNode"])("div",H,[K,Object(a["createVNode"])(q,{id:"name",name:"姓名",type:"text",class:Object(a["normalizeClass"])(["form-control rounded-0",{"is-invalid":c["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:u.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=function(e){return u.form.user.name=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(fe,{name:"姓名",class:"invalid-feedback"})]),Object(a["createElementVNode"])("div",Q,[R,Object(a["createVNode"])(q,{id:"tel",name:"電話",type:"tel",class:Object(a["normalizeClass"])(["form-control rounded-0",{"is-invalid":c["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:u.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=function(e){return u.form.user.tel=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(fe,{name:"電話",class:"invalid-feedback"})]),Object(a["createElementVNode"])("div",W,[Y,Object(a["createVNode"])(q,{id:"address",name:"地址",type:"text",class:Object(a["normalizeClass"])(["form-control rounded-0",{"is-invalid":c["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:u.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=function(e){return u.form.user.address=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(fe,{name:"地址",class:"invalid-feedback"})]),Object(a["createElementVNode"])("div",Z,[ee,Object(a["withDirectives"])(Object(a["createElementVNode"])("textarea",{name:"",id:"message",class:"form-control rounded-0",cols:"30",rows:"5","onUpdate:modelValue":t[5]||(t[5]=function(e){return u.form.message=e})},null,512),[[a["vModelText"],u.form.message]])])]})),_:1},8,["onSubmit"])])]),Object(a["createElementVNode"])("div",te,[ce,Object(a["createVNode"])(je,{ref:"form",class:"p-5 bg-light",onSubmit:k.createOrder},{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("div",ae,[oe,Object(a["createElementVNode"])("div",ne," NT$ "+Object(a["toDisplayString"])(e.$filters.currency(u.cartData.total)),1)]),re,le,0!==u.cartData.carts.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",se,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{type:"text",class:"form-control rounded-0","onUpdate:modelValue":t[6]||(t[6]=function(e){return u.coupon_code=e}),placeholder:"請輸入優惠碼"},null,512),[[a["vModelText"],u.coupon_code]]),Object(a["createElementVNode"])("div",de,[Object(a["createElementVNode"])("button",{class:"btn btn-soft rounded-0",type:"button",onClick:t[7]||(t[7]=function(){return k.addCouponCode&&k.addCouponCode.apply(k,arguments)})}," 套用優惠碼 ")])])):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",ie)),u.cartData.final_total!==u.cartData.total?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",ue,[Object(a["createElementVNode"])("div",me," 折扣價 "+Object(a["toDisplayString"])(e.$filters.currency(u.cartData.final_total)),1)])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("div",be," 總計 NT$ "+Object(a["toDisplayString"])(e.$filters.currency(u.cartData.final_total)),1)]})),_:1},8,["onSubmit"]),Object(a["createElementVNode"])("div",pe,[Object(a["createElementVNode"])("button",{class:"btn btn-soft rounded-0",onClick:t[8]||(t[8]=function(){return k.createOrder&&k.createOrder.apply(k,arguments)})}," 送出訂單 ")])])])):Object(a["createCommentVNode"])("",!0)])):Object(a["createCommentVNode"])("",!0)],64)}c("99af");var je=c("cfb9"),Oe={data:function(){return{products:[],product:{},cartData:{carts:{}},loadingItem:"",isLoading:!1,coupon_code:"2022",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},provide:function(){return{emitter:je["a"]}},watch:{$route:function(){this.$router.go(0)}},methods:{getProducts:function(){var e=this,t="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("jiangs2022vue3","/products/all");this.isLoading=!0,this.$http.get(t).then((function(t){e.products=t.data.products,console.log("產品列表:",t),e.isLoading=!1}))},getProduct:function(e){this.$router.push("/product/".concat(e))},getCarts:function(){var e=this;this.isLoading=!0,this.$http.get("".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("jiangs2022vue3","/cart")).then((function(t){e.isLoading=!1,console.log("購物車：",t),e.cartData=t.data.data}))},removeCartItem:function(e){var t=this;this.loadingItem=e;var c="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("jiangs2022vue3","/cart/").concat(e);this.isLoading=!0,this.$http.delete(c).then((function(e){t.$httpMessageState(e,"移除購物車品項"),t.loadingItem="",t.getCarts(),t.isLoading=!1,je["a"].emit("update-cart")}))},removeCart:function(){var e=this,t="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("jiangs2022vue3","/carts");this.isLoading=!0,this.$http.delete(t).then((function(t){e.$httpMessageState(t,"移除全部購物車品項"),e.getCarts(),e.isLoading=!1,je["a"].emit("update-cart")}))},updateCart:function(e){var t=this,c="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("jiangs2022vue3","/cart/").concat(e.id);this.isLoading=!0,this.loadingItem=e.id;var a={product_id:e.product_id,qty:e.qty};this.$http.put(c,{data:a}).then((function(e){console.log(e),t.loadingItem="",t.getCarts(),t.isLoading=!1,je["a"].emit("update-cart")}))},addCouponCode:function(){var e=this,t="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("jiangs2022vue3","/coupon"),c={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:c}).then((function(t){e.$httpMessageState(t,"加入優惠券"),e.getCarts(),e.isLoading=!1}))},createOrder:function(){var e=this,t="".concat("https://vue3-course-api.hexschool.io/v2","/api/").concat("jiangs2022vue3","/order"),c=this.form;this.$http.post(t,{data:c}).then((function(t){t.data.success&&(e.$router.push("/check/".concat(t.data.orderId)),e.$refs.form.resetForm(),e.isLoading=!1)}))}},mounted:function(){this.getProducts(),this.getCarts()}},ve=(c("711c"),c("6b0d")),he=c.n(ve);const ge=he()(Oe,[["render",fe]]);t["default"]=ge},8418:function(e,t,c){"use strict";var a=c("a04b"),o=c("9bf2"),n=c("5c6c");e.exports=function(e,t,c){var r=a(t);r in e?o.f(e,r,n(0,c)):e[r]=c}},"99af":function(e,t,c){"use strict";var a=c("23e7"),o=c("da84"),n=c("d039"),r=c("e8b5"),l=c("861d"),s=c("7b0b"),d=c("07fa"),i=c("8418"),u=c("65f0"),m=c("1dde"),b=c("b622"),p=c("2d00"),f=b("isConcatSpreadable"),j=9007199254740991,O="Maximum allowed index exceeded",v=o.TypeError,h=p>=51||!n((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),g=m("concat"),V=function(e){if(!l(e))return!1;var t=e[f];return void 0!==t?!!t:r(e)},N=!h||!g;a({target:"Array",proto:!0,forced:N},{concat:function(e){var t,c,a,o,n,r=s(this),l=u(r,0),m=0;for(t=-1,a=arguments.length;t<a;t++)if(n=-1===t?r:arguments[t],V(n)){if(o=d(n),m+o>j)throw v(O);for(c=0;c<o;c++,m++)c in n&&i(l,m,n[c])}else{if(m>=j)throw v(O);i(l,m++,n)}return l.length=m,l}})},b0c0:function(e,t,c){var a=c("83ab"),o=c("5e77").EXISTS,n=c("e330"),r=c("9bf2").f,l=Function.prototype,s=n(l.toString),d=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,i=n(d.exec),u="name";a&&!o&&r(l,u,{configurable:!0,get:function(){try{return i(d,s(this))[1]}catch(e){return""}}})},ef2a:function(e,t,c){}}]);
//# sourceMappingURL=chunk-41161d2a.d060ef82.js.map